<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="renderer" content="webkit">
    <link rel="stylesheet" href="{{ url_for('.static', filename='asset/mdui/css/mdui.min.css') }}">
    <script src="{{ url_for('.static', filename='asset/mdui/js/mdui.min.js') }}"></script>
    <script src="{{ url_for('.static', filename='js/jquery.min.js') }}"></script>
    <title>1finite-Admin</title>


</head>
<body class="mdui-theme-layout-dark mdui-appbar-with-toolbar mdui-theme-primary-indigo mdui-theme-accent-pink mdui-loaded mdui-drawer-body-left"
      style="margin-top: 20px;">

<header class="mdui-appbar mdui-appbar-fixed mdui-appbar-scroll-hide">
    <div class="mdui-toolbar mdui-color-indigo">
        <span class="mdui-btn mdui-btn-icon " mdui-drawer="{target: '#main-drawer', swipe: true}"><i
                class="mdui-icon material-icons">menu</i></span>
        <i class="mdui-icon material-icons">vpn_key</i>
        <a href="javascript:;" class="mdui-typo-headline">1finite-管理员页面</a>
        <!-- <a href="javascript:;" class="mdui-typo-title">动态</a> -->
        <div class="mdui-toolbar-spacer"></div>
        <div class="mdui-textfield mdui-textfield-expandable">
            <button class="mdui-textfield-icon mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">search</i>
            </button>
            <input class="mdui-textfield-input" type="text" placeholder="Search"/>
            <button class="mdui-textfield-close mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">close</i>
            </button>
        </div>
        <a href="javascript:;" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">person</i></a>
    </div>
</header>

<!-- 侧边栏 -->
<div class="mdui-drawer" id="main-drawer">

    <div class="mdui-list">
        <a class="mdui-list-item mdui-ripple" href="../">
            <i class="mdui-list-item-icon mdui-icon material-icons ">home</i>
            <div class="mdui-list-item-content">首页</div>
        </a>

        <a class="mdui-list-item mdui-ripple" href="../visitor">
            <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-blue">assignment_turned_in</i>
            <div class="mdui-list-item-content">访客记录</div>
        </a>
        <a class="mdui-list-item mdui-ripple mdui-list-item-active">
            <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-blue">assignment_ind</i>
            <div class="mdui-list-item-content">用户管理</div>
        </a>
        <a class="mdui-list-item mdui-ripple" href="../channel">
            <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-blue">keyboard_voice</i>
            <div class="mdui-list-item-content">频道管理</div>
        </a>
        <a class="mdui-list-item mdui-ripple" href="../topic">
            <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-blue">chat_bubble</i>
            <div class="mdui-list-item-content">话题管理</div>
        </a>
        <a class="mdui-list-item mdui-ripple" href="../game">
            <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-blue">videogame_asset</i>
            <div class="mdui-list-item-content">游戏公墓</div>
        </a>
    </div>
</div>

<div class="mdui-container">
    <h4>用户管理</h4>
    <button class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-theme-accent" onclick="load_user()">获取</button>
    <table class="mdui-table mdui-table-hoverable">
        <thead>
        <tr>
            <th>ID</th>
            <th>uesername</th>
            <th>admin</th>
            <th>ban</th>
            <th>nickname</th>
            <th>sex</th>
            <th>编辑</th>
            <th>删除</th>
        </tr>
        </thead>
        <tbody id="user_table">

        </tbody>
    </table>
    {#    编辑页面#}
    <div class="mdui-dialog" id="editDialog">
        <div class="mdui-dialog-title">Edit</div>
        <div class="mdui-dialog-content">You'll lose all photos and media!</div>
        <div class="mdui-dialog-actions">
            <button class="mdui-btn mdui-ripple" mdui-dialog-close>cancel</button>
            <button class="mdui-btn mdui-ripple" mdui-dialog-confirm>erase</button>
        </div>
    </div>

    {#    删除页面#}
    <div class="mdui-dialog" id="deleteDialog">
        <div class="mdui-dialog-title">Delete</div>
        <div class="mdui-dialog-content">You'll lose all photos and media!</div>
        <div class="mdui-dialog-actions">
            <button class="mdui-btn mdui-ripple" mdui-dialog-close>cancel</button>
            <button class="mdui-btn mdui-ripple" mdui-dialog-confirm>erase</button>
        </div>
    </div>
</div>


<script>
    mdui.mutation();
    let edit_dialog = new mdui.Dialog("#editDialog")
    let delete_dialog = new mdui.Dialog("#deleteDialog")

    function open_edit_dialog() {
        edit_dialog.open();
    }

    function open_delete_dialog() {
        delete_dialog.open();
    }

    function load_user() {
        let oTab = document.getElementById('user_table');
        $.post('/api/users/list', {'page': 1}, function (d) {
            if (0 == d.status) {
                for (let i = 0; i < d.data.length; i++) {
                    let oTr = document.createElement('tr');
                    oTr.innerHTML = '<td>' + d.data[i].id + '</td>' + '<td>' + d.data[i].username + '</td>' + '<td>' + d.data[i].admin + '</td>' + '<td>' + d.data[i].ban + '</td>' + '<td>' + d.data[i].nickname + '</td>' + '<td>' + d.data[i].sex + '</td>' + '<td><button class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-theme-accent" onclick="open_edit_dialog()">编辑</button></td>' + '<td><button class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-theme-accent" onclick="open_delete_dialog()">删除</button></td>';
                    oTab.appendChild(oTr);
                }
                mdui.mutation();
            }
            else if (2 == d.status) {
                for (let i = 0; i < d.data.length; i++) {
                    let oTr = document.createElement('tr');
                    oTr.innerHTML = '<td>' + d.data[i].id + '</td>' + '<td>' + d.data[i].username + '</td>' + '<td>' + d.data[i].admin + '</td>' + '<td>' + d.data[i].ban + '</td>' + '<td>' + d.data[i].nickname + '</td>' + '<td>' + d.data[i].sex + '</td>' + '<td><button class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-theme-accent" onclick="open_edit_dialog()">编辑</button></td>' + '<td><button class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-theme-accent" onclick="open_delete_dialog()">删除</button></td>';
                    oTab.appendChild(oTr);
                }
                mdui.mutation();
            }
            else if (1 == d.status) {
                mdui.alert(d.message)
            }
        })
    }
    load_user();
</script>
</body>
</html>